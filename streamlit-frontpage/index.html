
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="FoaPy is a Python package for formal order analysis of sequences">
      
      
      
      
      
        <link rel="next" href="fundamentals/">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>FoaPy</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.a40c8224.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_markdown_exec_pyodide.css">
    
      <link rel="stylesheet" href="assets/_markdown_exec_ansi.css">
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="assets/css/custom.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#foapy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="FoaPy" class="md-header__button md-logo" aria-label="FoaPy" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            FoaPy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Home
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/intervals-mining-lab/foapy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    intervals-mining-lab/foapy
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="fundamentals/" class="md-tabs__link">
        
  
    
  
  Fundamentals

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="references/alphabet/" class="md-tabs__link">
          
  
    
  
  References

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="development/development/" class="md-tabs__link">
          
  
    
  
  Development

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="FoaPy" class="md-nav__button md-logo" aria-label="FoaPy" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    FoaPy
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/intervals-mining-lab/foapy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    intervals-mining-lab/foapy
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="fundamentals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fundamentals
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    References
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            References
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/alphabet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    foapy.alphabet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/order/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    foapy.order
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/intervals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    foapy.intervals
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/binding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    foapy.binding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/mode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    foapy.mode
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="references/ma/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    foapy.ma
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            foapy.ma
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/ma/alphabet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    alphabet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/ma/order/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    order
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/ma/intervals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    intervals
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="references/characteristics/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    foapy.characteristics
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            foapy.characteristics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/characteristics/arithmetic_mean/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    arithmetic_mean
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/characteristics/average_remoteness/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    average_remoteness
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/characteristics/depth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    depth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/characteristics/descriptive_information/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    descriptive_information
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/characteristics/geometric_mean/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    geometric_mean
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/characteristics/identifying_information/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    identifying_information
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/characteristics/regularity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    regularity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/characteristics/uniformity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    uniformity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/characteristics/volume/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    volume
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7_11" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="references/characteristics/ma/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ma
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7_11" id="__nav_3_7_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_7_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7_11">
            <span class="md-nav__icon md-icon"></span>
            ma
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/characteristics/ma/arithmetic_mean/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    arithmetic_mean
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/characteristics/ma/average_remoteness/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    average_remoteness
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/characteristics/ma/depth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    depth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/characteristics/ma/geometric_mean/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    geometric_mean
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/characteristics/ma/identifying_information/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    identifying_information
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/characteristics/ma/periodicity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    periodicity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/characteristics/ma/uniformity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    uniformity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/characteristics/ma/volume/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    volume
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="references/exceptions/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    foapy.exceptions
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_8">
            <span class="md-nav__icon md-icon"></span>
            foapy.exceptions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/exceptions/inconsistent_order/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    InconsistentOrderException
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/exceptions/not_1d_array/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Not1DArrayException
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Development
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="development/development/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Development
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="development/benchmarks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Benchmarks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="development/coverage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code coverage
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<style>
h1 {
  display: none;
}
</style>
<h1 id="foapy">FoaPy</h1>
<p>FoaPy is a library for conducting Formal Order Analysis on symbol sequences.</p>
<p>It treats the concept of 'order' as a fundamental property of sequences and provides order-sensitive metrics to analyze, differentiate, and compare their structural patterns.</p>
<div id="playground-root"></div>
<script type="module">
  import { mount } from './assets/js/playground.js';
  const helpersCode=`import streamlit as st
import foapy
import numpy as np
from streamlit_sortables import sort_items

if 'characteristics' not in st.session_state:
  st.session_state['characteristics'] = []

if 'sort_mode' not in st.session_state:
  st.session_state['sort_mode'] = None

def set_theme():
  st.markdown('<link rel="stylesheet" href="assets/css/streamlit.css">', unsafe_allow_html=True)

def source_widget(text):
    set_theme()
    with st.popover("__a sequence__", use_container_width=True):
      source = st.text_area("", text,
        key="source")
      source = source.replace("\\n", " ").lower()
      separator = st.text_input("Split by", " ").lower()

    source = source.split(separator) if separator else list(source)

    if st.session_state.sort_mode == "alphabetically":
      source = sorted(source)
    elif st.session_state.sort_mode == "random":
      rng = np.random.default_rng(st.session_state['random_seed'])
      source = list(rng.permutation(source))

    return source

def capitalize(value):
  return value.title()

def saveRandomOrderSeed():
  if st.session_state.sort_mode == "random":
    rng = np.random.default_rng()
    seeds = rng.integers(2^32, size=1)
    st.session_state['random_seed'] = seeds[0]

def sort_modes_widget():
  if len(st.session_state['characteristics']):
    with st.popover(":material/stat_3: Drag and drop to change the order or use this modes", use_container_width=True):
      st.segmented_control("", options=["alphabetically", "random"], key="sort_mode", format_func=capitalize, on_change=saveRandomOrderSeed)

def sort_widget(value):
  sequence = sort_items(value)
  sort_modes_widget()
  return sequence

def sequence_widget(value):
  return sort_widget(source_widget(value))

def palette(seq):
  import numpy as np
  import seaborn as sns

  power = len(seq)
  palette = "husl" if power > 20 else "tab20"
  return np.asarray(
    sns.color_palette(palette, power).as_hex()
  )

def show(seq, colors):
  from streamlit_extras.tags import tagger_component
  set_theme()

  if len(seq) != len(colors):
    tagger_component("", seq, list(colors[seq]))
  else:
    tagger_component("", seq, list(colors))

def array2image(seq, colors):
  import io
  import base64
  import numpy as np
  from skimage.transform import rescale
  from PIL import Image

  # Create a 1D image from the colors array
  colors_array = np.array(
    [
      tuple(
        int(c.lstrip('#')[i:i+2], 16) for i in (0, 2, 4)
      ) for c in colors[seq]
    ]
  )

  colors_array = colors_array.reshape(1, len(colors[seq]), 3)
  colors_array = rescale(colors_array, [25, 5, 1], order=0)

  # Convert to base64
  buffered = io.BytesIO()
  img = Image.fromarray(np.uint8(colors_array))
  img.save(buffered, format="PNG")
  img_str = base64.b64encode(buffered.getvalue()).decode()
  return f"data:image/png;base64,{img_str}"

column_config = {
  "order": None,
  "img": st.column_config.ImageColumn(
    "Order",
    help="Order",
    width="medium"
  ),
  "arithmetic mean": st.column_config.NumberColumn(
    "Δa",
    help="Arithmetic mean",
  ),
  "geometric mean": st.column_config.NumberColumn(
    "Δg",
    help="Geometric mean",
  ),
  "average remotness": st.column_config.NumberColumn(
    "g",
    help="Average remotness",
  ),
  "depth": st.column_config.NumberColumn(
    "G",
    help="Depth",
  ),
  "identifying information": st.column_config.NumberColumn(
    "H",
    help="Identifying informations / Entropy",
  ),
  "descriptive information": st.column_config.NumberColumn(
    "D",
    help="Descriptive information",
  ),
  "regularity": st.column_config.NumberColumn(
    "r",
    help="Regularity",
  ),
  "uniformity": st.column_config.NumberColumn(
    "u",
    help="Uniformity",
  )
}

def store_data(item):
  import pandas as pd

  def form_callback(data):
    first_time = len(st.session_state['characteristics']) == 0
    for item in st.session_state['characteristics']:
      if item["img"] == data["img"]:
        return
    st.session_state['characteristics'].append(data)
    if first_time:
      st.balloons()

  df = pd.DataFrame([item])

  st.dataframe(df,
    column_config=column_config,
    use_container_width=True,
    hide_index=True,
    key="current"
  )

  st.button("Add to chart",
    help="Add measures to chart",
    on_click=form_callback,
    args=(item,),
    type="secondary",
    use_container_width=True
  )
  if len(st.session_state['characteristics']):
    st.info("Now change the order to see the difference",  icon=":material/stat_3:")

def display_data(current):
  import altair as alt
  import pandas as pd

  if not st.session_state.characteristics:
    return

  data = st.session_state.characteristics if st.session_state.characteristics else [current]

  df = pd.DataFrame(data)

  df_chart = pd.DataFrame([current] + st.session_state.characteristics)

  chart, table = st.tabs(["Chart", "Data"])

  with table:
    st.dataframe(df,
      column_config=column_config,
      use_container_width=True,
      hide_index=True
    )

  options = list(current.keys())[1:]

  def options_format_callback(option):
    if column_config[option]:
      data = column_config[option]
      return f"{data['label']} ({data['help']})"
    return option.title()

  with chart:
    with st.popover("axis", use_container_width=True):
      x = st.selectbox(
          "X",
          key="x",
          index=0,
          options=options,
          format_func=options_format_callback
      )
      y = st.selectbox(
          "Y",
          key="y",
          index=1,
          options=options[1:],
          format_func=options_format_callback
      )

    if x == "order":
      x_encode = alt.X(x, type="ordinal")
      x_order_encode = alt.X(x, type="ordinal", axis=alt.Axis(labelExpr=""))
    else:
      x_encode = x
      x_order_encode = alt.X(x, type="ordinal", axis=alt.Axis(labelExpr=""))
    c = (
       alt.Chart(df_chart)
       .mark_line(point = True)
       .encode(
         x=x_encode,
         y=alt.Y(y, type="quantitative"),
       )
       +
       alt.Chart(df_chart)
       .mark_image(height=10)
       .transform_calculate(y, "-.4")
       .encode(
         x=x_order_encode,
         y=alt.Y(y, type="quantitative", scale=alt.Scale(domain=[0, 10])),
         url=alt.Url("img", type="nominal"),
         tooltip=alt.Tooltip("order"),
       )
    )

    st.altair_chart(c, use_container_width=True)

def draw_chart(item):
  store_data(item)
  display_data(item)
`;

  const code=`import streamlit as st
import foapy
import numpy as np
from helpers import array2image, palette, show
from helpers import draw_chart, sequence_widget

'''
### Formal Order Analysis decomposes
'''

sequence = sequence_widget(
"""Peter Piper picked a peck of pickled peppers
A peck of pickled peppers Peter Piper picked
If Peter Piper picked a peck of pickled peppers
Where's the peck of pickled peppers Peter Piper picked"""
)

'into'

order, alphabet = foapy.order(
  sequence, return_alphabet=True
)
orderCongeneric = foapy.ma.order(np.asarray(sequence))

colors = palette(alphabet)

'''### alphabet'''
show(alphabet, colors)
'and'
'''### order'''
show(order, colors)

'''
### and provides various order-sensitive measures
'''
intervals = foapy.intervals(
  order, foapy.binding.start, foapy.mode.cycle
)
intervalsCongeneric = foapy.ma.intervals(
  orderCongeneric, foapy.binding.start, foapy.mode.cycle
)

measures = {
  "img": array2image(order, colors),
  "order": np.array2string(order),
  "arithmetic mean": foapy.characteristics.arithmetic_mean(intervals),
  "geometric mean": foapy.characteristics.geometric_mean(intervals),
  "average remotness": foapy.characteristics.average_remoteness(intervals),
  "depth": foapy.characteristics.depth(intervals),
  "identifying information": foapy.characteristics.identifying_information(intervalsCongeneric),
  "descriptive information": foapy.characteristics.descriptive_information(intervalsCongeneric),
  "regularity": foapy.characteristics.regularity(intervalsCongeneric),
  "uniformity": foapy.characteristics.uniformity(intervalsCongeneric),
}

draw_chart(measures)







`

      // The library is available as ReactStlitePlayground
      mount({
        initialCode: code,
        files: {
          "helpers.py": helpersCode,
        },
        requirements: [
          "https://intervals-mining-lab.github.io/foapy/streamlit-frontpage/assets/streamlit_sortables-0.3.1-py3-none-any.whl",
          "foapy",
          "pandas",
          "streamlit-extras==0.6.0",
          "seaborn",
          "scikit-image"
        ],
      },
      document.getElementById("playground-root")
      );
</script>







  
  




  



                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  
    
  



  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.path", "navigation.indexes", "navigation.tracking", "content.code.copy", "content.code.annotate", "content.tabs.link"], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"alias": true, "provider": "mike"}}</script>
    
    
      <script src="assets/javascripts/bundle.60a45f97.min.js"></script>
      
        <script src="assets/_markdown_exec_pyodide.js"></script>
      
        <script src="assets/js/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>